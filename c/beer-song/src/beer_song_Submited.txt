#include "beer_song.h"

void recite(unsigned int start_bottles, unsigned int take_down, char *buffer)
{

  buffer[0] = '\0';

  char *TwoBottles =
    "2 bottles of beer on the wall, 2 bottles of beer.\n"
    "Take one down and pass it around, 1 bottle of beer on the wall.\n";
    
  char *OneBottle =    
    "1 bottle of beer on the wall, 1 bottle of beer.\n"
    "Take it down and pass it around, no more bottles of beer on the wall.\n";

  char *ZeroBottle =
    "No more bottles of beer on the wall, no more bottles of beer.\n"
    "Go to the store and buy some more, 99 bottles of beer on the wall.\n";

  char temp[PHRASE_BUFFER];

  char *nl = "\n";


  while(take_down != 0)
  {

    switch(start_bottles)
    {
      case 0:
        memcpy(temp, ZeroBottle, strlen(ZeroBottle)+1);
        break;
      case 1:
        memcpy(temp, OneBottle, strlen(OneBottle)+1);
        break;
      case 2:
        memcpy(temp, TwoBottles, strlen(TwoBottles)+1);
        break;
      default:
        sprintf(temp,\
          "%i bottles of beer on the wall, %i bottles of beer.\n"\
          "Take one down and pass it around, %i bottles of beer on the wall.\n"\
        , start_bottles, start_bottles, start_bottles - 1);
    }

    strncat(buffer, temp, strlen(temp));

    if(take_down - 1 != 0) strncat(buffer, nl, strlen(nl));

    --start_bottles;
    --take_down;
  }
}
